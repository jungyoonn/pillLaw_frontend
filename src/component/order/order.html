<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>ORDER</title>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/js/all.min.js" integrity="sha512-b+nQTCdtTBIRIbraqNEwsjB6UvL3UEMkXnhzd8awtCYh0Kcsjl9uEgwVFVbhoj3uu1DO1ZMacNvLoyJJiNfcvg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="icon" href="../../resources/image/pilllaw_favicon.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Noto+Sans+KR&display=swap" rel="stylesheet">
  <link rel='stylesheet' href='../../resources/css/style.css'>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js"></script>
  <style>
    header {
    position: fixed;
    z-index: 10; /* 헤더가 메인 콘텐츠 위로 오도록 설정 */
    }
    main {
      z-index: 1; /* 메인 콘텐츠가 헤더 아래로 오도록 설정 */
    }
    .form-container {
      width: 600px;
      margin: 0 auto; /* 가운데 정렬 */
    }
  </style>
</head>

<body class="noto-sans-kr">
  <div class="wrap">
    <header class="container-fluid mb-0" style="position: fixed; background-color: #F8F9FA;">
      <div class="container clearfix">
        <div class="row">
          <div class="col-3 p-0">
            <a href="#" class="float-start m-2"><img class="img-fluid header-icon" src="../../resources/image/pilllaw_icon_crop.png" alt="아이콘"></a>
            <h2 class="float-start mt-4 ms-3 pt-3 fw-bold"><a class="text-decoration-none header-font " href="#">PILL LAW</a></h2>
          </div>
          <div class="col">
            <div class="float-start py-4 ps-5">
              <h6 class="float-start m-4 text-center fw-bold"><a class="text-decoration-none header-font pt-4" href="#">전체 상품</a></h6>
              <h6 class="float-start m-4 text-center fw-bold"><a class="text-decoration-none header-font pt-4" href="#">구독하기</a></h6>
              <h6 class="float-start m-4 text-center fw-bold"><a class="text-decoration-none header-font pt-4" href="#">필로</a></h6>
              <h6 class="float-start m-4 text-center fw-bold"><a class="text-decoration-none header-font pt-4" href="#">마이페이지</a></h6>
            </div>
            <div class="float-end py-4">
              <i class="fa-solid fa-user fa-lg header-font float-end mx-2 pt-4 text-center"></i>
              <i class="fa-solid fa-cart-shopping fa-lg header-font float-end mx-2 pt-4 text-center"></i>
              <i class="fa-solid fa-bell fa-lg header-font float-end mx-2 pt-4 text-center"></i>
              <i class="fa-solid fa-magnifying-glass fa-lg header-font float-end mx-2 pt-4 text-center"></i>
              <i class="fa-solid fa-comment-dots fa-lg header-font float-end mx-2 pt-4 text-center"></i>
              <p class="float-end mx-2 pt-4 text-center fw-bold fs-12"><a class="header-font pt-3" href="#">회원가입</a></p>
              <p class="float-end pt-4 text-center fw-bold fs-12"><a class="header-font pt-3" href="#">로그인</a></p>
            </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    
    <main class="container px-0" style="padding-top: 115.19px;">
      <!-- <h4 class="text-center fw-bold mb-4"><span class="header-font">1.장바구니</span> <span class="header-font">2.주문서 작성</span> <span class="header-font">3. 작성완료</span></h4> -->
      <h4 class="text-center fw-bold mb-4">
        <span class="header-font text-secondary">1. 장바구니</span>
        <span class="header-font mx-5">2. 주문서 작성</span>
        <span class="header-font text-secondary">3. 결제 완료</span>
      </h4>

      <h5><strong>배송지</strong></h5><hr>
      <div class="row">
        <div class="col-md-6">
          <form class="form-container" id="orderForm">
            <div class="mb-3">
              <label for="recipientName" class="form-label">받는사람</label>
              <input type="text" class="form-control" id="recipientName" required>
            </div>
            <div class="mb-3">
              <label for="address" class="form-label">주소</label>
              <div class="input-group">
                <input type="text" class="form-control" id="postcode" readonly placeholder="우편번호">
                <button type="button" class="btn btn-pilllaw" id="searchAddress">주소 검색</button>
              </div>
              <input type="text" class="form-control mt-2" id="basicAddress" readonly placeholder="기본주소">
              <input type="text" class="form-control mt-2" id="detailAddress" placeholder="상세주소" required>
            </div>
            <div class="mb-3">
              <label for="phone" class="form-label">휴대전화</label>
              <input type="text" class="form-control" id="phone" placeholder="010-1234-5678" required>
            </div>
            <div class="mb-3">
              <label for="deliveryMessage" class="form-label">배송 메세지</label>
              <select class="form-select" id="deliveryMessage">
                <option value="경비실">경비실</option>
                <option value="집앞">집앞</option>
                <option value="택배함">택배함</option>
                <option value="직접배송">직접배송</option>
                <option value="배송전 연락">배송전 연락</option>
                <option value="직접입력">직접 입력</option>
              </select>
              <!-- 직접 입력 시 나타나는 텍스트 영역 -->
              <textarea class="form-control mt-2" id="customMessage" style="display:none" placeholder="직접 입력해 주세요"></textarea>
            </div>
          </form>
        </div>
      </div>
      <hr>
      <h5 class="mt-5"><strong>주문 상품</strong></h5><hr>
      <table class="table text-center align-middle">
        <thead class="table-light">
          <tr>
            <th width="10%">상품</th>
            <th width="50%">상품명(구독기간)</th>
            <th width="10%">가격</th>
            <th width="10%">수량</th>
            <th width="10%">합계</th>
          </tr>
        </thead>
        <tbody id="orderTableBody">
          <!-- 상품이 동적으로 추가될 부분 -->
        </tbody>
      </table>
      <hr>
      <!-- 총 결제 금액 및 적립 예정 포인트 -->
      <div class="d-flex justify-content-between mt-3">
        <p class="fw-bold" id="totalPriceText">총 금액(배송비 포함) <span id="finalPriceAfterPoints">0</span>원</p>
        <p id="expectedPointsText"><span id="expectedPoints">0</span>P가 적립될 예정입니다(배송 완료 후 1주일 이내)</p>
     </div>
      <div class="mb-3 text-start">
        <label for="usePoints" class="form-label fw-bold">사용 포인트</label><small>(보유 포인트: 5000P)</small>
        <input type="number" id="usePoints" class="form-control form-control-sm w-25" placeholder="포인트 입력">
      </div>
      <p class="fw-bold" id="totalPriceText">총 결제금액 <span id="finalPriceAfterPoints">0</span>원</p>
      
      <div class="d-flex justify-content-center">
        <button type="button" class="btn btn-pilllaw" onclick="placeOrder()">결제하기</button>
      </div>
    </main>

    </main>
     
    <footer class="container-fluid">
      <hr class="text-pilllaw">
      <div class="container clearfix mb-4">
        <div class="row">
          <div class="col-3">
            <a href="#"><img src="../../resources/image/pilllaw_icon.png" class="img-fluid" alt="footer logo" width="200"></a>
          </div>
          <div class="col mt-3">
            <p class="fs-14 header-font fw-bold mb-0">상호명: PILL LAW</p>
            <p class="fs-14 header-font fw-bold mb-0">주소: 서울특별시 구로구 디지털로 306 대륭포스트타워 2차</p>
            <p class="fs-14 header-font fw-bold mb-0">고객센터: 010-5306-3569</p>
            <p class="fs-14 header-font fw-bold mb-0">계좌번호: 국민 040002-04-207375</p>
          </div>
          <div class="col mt-3 text-center">
            <a href="#" class="header-font text-decoration-none fw-bold"><i class="fa-brands fa-github fa-2xl header-font"></i></a>
            <a href="#" class="header-font text-decoration-none fw-bold fs-14"><br>GitHub 방문하기</a>
          </div>
        </div>
        <div class="row mb-2">
          <div class="col"></div>
          <div class="col">
            <p class="fs-14 header-font text-center fw-bold mb-2">개인정보 처리방침</p>
          </div>
          <div class="col">
            <p class="fs-14 header-font text-center fw-bold mb-2">이용약관</p>
          </div>
          <div class="col">
            <p class="fs-14 header-font text-center fw-bold mb-2">이용안내</p>
          </div>
          <div class="col"></div>
        </div>
        <p class="fs-14 header-font text-center fw-bold mb-2">All rights resereved PILLLAW &copy; copyright.</p>
      </div>
    </footer>
  </div>
</body>

<script>
   // 배송 메세지 선택 시 직접 입력 텍스트박스 토글
   document.getElementById("deliveryMessage").addEventListener("change", function () {
      const customMessageField = document.getElementById("customMessage");
      if (this.value === "직접입력") {
        customMessageField.style.display = 'block';
      } else {
        customMessageField.style.display = 'none';
      }
    });
  
    let cartItems = [
      { id: 1, img: "https://placehold.co/60", name: "콜린 미오 이노시톨", price: 20000, option: "30일", quantity: 1 },
      { id: 2, img: "https://placehold.co/60", name: "철분 24mg", price: 15000, option: "60일", quantity: 1 },
      { id: 3, img: "https://placehold.co/60", name: "종합비타민", price: 16000, option: "30일", quantity: 1 },
      { id: 4, img: "https://placehold.co/60", name: "코큐텐", price: 19000, option: "90일", quantity: 2 },
      { id: 5, img: "https://placehold.co/60", name: "루테인 오메가", price: 35000, option: "30일", quantity: 3 },
      { id: 6, img: "https://placehold.co/60", name: "가르시니아", price: 25000, option: "30일", quantity: 1 }
    ];

    let userMembershipStatus = "ACTIVE";


  function updateCart() {
    const tableBody = document.getElementById("orderTableBody");
    tableBody.innerHTML = "";
    let totalPrice = 0;
  
    cartItems.forEach(item => {
      let optionMultiplier = 1; // 기본 배수는 1
      if (item.option === "60일") {
        optionMultiplier = 2; // 60일 옵션일 경우 배수 2
      } else if (item.option === "90일") {
        optionMultiplier = 3; // 90일 옵션일 경우 배수 3
      }

      let itemTotal = item.price * optionMultiplier * item.quantity; // 배수 적용한 가격 계산
      totalPrice += itemTotal;

      tableBody.innerHTML += `
        <tr>
          <td><img src="${item.img}" class="img-fluid"></td>
          <td>${item.name} (${item.option})</td>
          <td>${(item.price * optionMultiplier).toLocaleString()}원</td>
          <td>${item.quantity}</td>
          <td>${itemTotal.toLocaleString()}원</td>
        </tr>`;
    });

    document.getElementById("finalPriceAfterPoints").textContent = totalPrice.toLocaleString();
  

    let pointsRate = 0;
    if (userMembershipStatus === "ACTIVE") {
      pointsRate = 0.04; // ACTIVE 상태일 경우 4% 적립 (구독회원)
    } else{
      pointsRate = 0.02; // EXPIRED 상태일 경우 2% 적립 (일반회원)
    }

    // 적립 예정 포인트 계산
    let expectedPoints = Math.floor(totalPrice * pointsRate);
    document.getElementById("expectedPoints").textContent = expectedPoints.toLocaleString();
  }
  updateCart();
 

 
</script>
</html> 